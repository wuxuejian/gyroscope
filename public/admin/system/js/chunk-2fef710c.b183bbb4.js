(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2fef710c"],{bead:function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"station"},[l("el-drawer",{attrs:{"append-to-body":!0,"before-close":e.handleClose,direction:e.direction,modal:!0,size:e.formData.width,title:e.formData.title?e.formData.title:e.title,visible:e.drawer,"wrapper-closable":!0,wrapperClosable:!1},on:{"update:visible":function(t){e.drawer=t}}},[l("div",{staticClass:"invoice"},[l("el-form",{ref:"form",attrs:{model:e.rules,rules:e.rule,"label-width":"110px"}},[l("div",{staticClass:"from-item-title mb15"},[l("span",[e._v(e._s(e.$t("setting.info.essentialinformation")))])]),e._v(" "),l("div",{staticClass:"form-box"},[l("div",{staticClass:"form-item"},[l("el-form-item",[l("span",{attrs:{slot:"label"},slot:"label"},[l("span",{staticClass:"color-tab"},[e._v("* ")]),e._v("客户名称:")]),e._v(" "),l("span",{staticClass:"font-color"},[e._v(e._s(e.rules.source))])])],1),e._v(" "),l("div",{staticClass:"form-item"},[l("el-form-item",[l("span",{attrs:{slot:"label"},slot:"label"},[l("span",{staticClass:"color-tab"},[e._v("* ")]),e._v(e._s(e.$t("customer.contractname"))+":")]),e._v(" "),l("span",{staticClass:"font-color"},[e._v(e._s(e.rules.name))])])],1),e._v(" "),l("div",{staticClass:"form-item"},[l("el-form-item",{attrs:{prop:"category_id"}},[l("span",{attrs:{slot:"label"},slot:"label"},[e._v("发票类目:")]),e._v(" "),l("el-select",{attrs:{placeholder:e.$t("customer.placeholder45"),clearable:"",size:"small"},model:{value:e.rules.category_id,callback:function(t){e.$set(e.rules,"category_id",t)},expression:"rules.category_id"}},e._l(e.categoryList,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),e._v(" "),l("div",{staticClass:"form-item"},[l("el-form-item",{attrs:{prop:"bill_date"}},[l("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(e.$t("customer.invoicingdate"))+":")]),e._v(" "),l("el-date-picker",{attrs:{placeholder:e.$t("customer.placeholder65"),clearable:"",size:"small",type:"date"},model:{value:e.rules.bill_date,callback:function(t){e.$set(e.rules,"bill_date",t)},expression:"rules.bill_date"}})],1)],1)]),e._v(" "),l("div",{staticClass:"line"}),e._v(" "),l("div",{staticClass:"from-item-title mb15"},[l("span",[e._v(e._s(e.$t("customer.mailinginformation")))])]),e._v(" "),l("div",{staticClass:"form-box"},[l("div",{staticClass:"form-item",staticStyle:{width:"100%"}},[l("el-form-item",[l("span",{attrs:{slot:"label"},slot:"label"},[e._v("开票要求:")]),e._v(" "),l("el-radio-group",{on:{change:e.collectTypeFn},model:{value:e.rules.collect_type,callback:function(t){e.$set(e.rules,"collect_type",t)},expression:"rules.collect_type"}},[l("el-radio",{attrs:{label:"mail"}},[e._v("电子")]),e._v(" "),l("el-radio",{attrs:{label:"express"}},[e._v("纸质")])],1)],1)],1),e._v(" "),"express"==e.rules.collect_type?l("div",{staticClass:"form-item"},[l("el-form-item",{attrs:{prop:"collect_name"}},[l("span",{attrs:{slot:"label"},slot:"label"},[e._v("联系人:")]),e._v(" "),l("el-input",{attrs:{placeholder:e.$t("customer.placeholder52"),clearable:"",size:"small"},model:{value:e.rules.collect_name,callback:function(t){e.$set(e.rules,"collect_name","string"===typeof t?t.trim():t)},expression:"rules.collect_name"}})],1)],1):e._e(),e._v(" "),"express"==e.rules.collect_type?l("div",{staticClass:"form-item"},[l("el-form-item",{attrs:{prop:"collect_tel"}},[l("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(e.$t("customer.contactnumber"))+":")]),e._v(" "),l("el-input",{attrs:{placeholder:e.$t("customer.placeholder53"),clearable:"",size:"small"},model:{value:e.rules.collect_tel,callback:function(t){e.$set(e.rules,"collect_tel","string"===typeof t?t.trim():t)},expression:"rules.collect_tel"}})],1)],1):e._e(),e._v(" "),"mail"==e.rules.collect_type?l("div",{staticClass:"form-item"},[l("el-form-item",{attrs:{prop:"collect_email"}},[l("span",{attrs:{slot:"label"},slot:"label"},[e._v("邮箱地址:")]),e._v(" "),l("el-input",{attrs:{placeholder:e.$t("customer.placeholder55"),clearable:"",size:"small"},model:{value:e.rules.collect_email,callback:function(t){e.$set(e.rules,"collect_email",t)},expression:"rules.collect_email"}})],1)],1):l("div",{staticClass:"form-item"},[l("el-form-item",{attrs:{prop:"mail_address"}},[l("span",{attrs:{slot:"label"},slot:"label"},[e._v("邮寄地址:")]),e._v(" "),l("el-input",{attrs:{placeholder:e.$t("customer.placeholder56"),clearable:"",size:"small"},model:{value:e.rules.mail_address,callback:function(t){e.$set(e.rules,"mail_address","string"===typeof t?t.trim():t)},expression:"rules.mail_address"}})],1)],1)]),e._v(" "),l("div",{staticClass:"line"}),e._v(" "),l("div",{staticClass:"from-item-title mb15"},[l("span",[e._v(e._s(e.$t("customer.invoiceinformation")))])]),e._v(" "),l("div",{staticClass:"form-box"},[l("div",{staticClass:"form-item"},[l("el-form-item",[l("span",{attrs:{slot:"label"},slot:"label"},[l("span",{staticClass:"color-tab"},[e._v("* ")]),e._v(e._s(e.$t("customer.headerinformation"))+":")]),e._v(" "),l("el-select",{attrs:{placeholder:e.$t("customer.placeholder45"),clearable:"",size:"small"},model:{value:e.rules.types,callback:function(t){e.$set(e.rules,"types",t)},expression:"rules.types"}},e._l(e.invoiceOptions,(function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),l("div",{staticClass:"form-item"},[l("el-form-item",{attrs:{prop:"amount"}},[l("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(e.$t("customer.invoicingpay"))+":")]),e._v(" "),l("el-input-number",{attrs:{controls:!1,min:0,placeholder:e.$t("customer.placeholder44"),precision:2,clearable:"",size:"small"},model:{value:e.rules.amount,callback:function(t){e.$set(e.rules,"amount",t)},expression:"rules.amount"}})],1)],1),e._v(" "),l("div",{staticClass:"form-item"},[l("el-form-item",{attrs:{prop:"title"}},[l("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(e.$t("customer.invoiceheader"))+":")]),e._v(" "),l("el-input",{attrs:{placeholder:e.$t("customer.placeholder46"),clearable:"",size:"small"},model:{value:e.rules.title,callback:function(t){e.$set(e.rules,"title","string"===typeof t?t.trim():t)},expression:"rules.title"}})],1)],1),e._v(" "),e.rules.types>1?l("div",{staticClass:"form-item"},[l("el-form-item",{attrs:{prop:"ident"}},[l("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(e.$t("customer.paytaxes"))+":")]),e._v(" "),l("el-input",{attrs:{placeholder:e.$t("customer.placeholder47"),clearable:"",size:"small"},model:{value:e.rules.ident,callback:function(t){e.$set(e.rules,"ident","string"===typeof t?t.trim():t)},expression:"rules.ident"}})],1)],1):e._e(),e._v(" "),e.rules.types>2?l("div",{staticClass:"form-item"},[l("el-form-item",[l("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(e.$t("customer.bankdeposit"))+":")]),e._v(" "),l("el-input",{attrs:{placeholder:e.$t("customer.placeholder48"),clearable:"",size:"small"},model:{value:e.rules.bank,callback:function(t){e.$set(e.rules,"bank","string"===typeof t?t.trim():t)},expression:"rules.bank"}})],1)],1):e._e(),e._v(" "),e.rules.types>2?l("div",{staticClass:"form-item"},[l("el-form-item",[l("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(e.$t("customer.accountnumber"))+":")]),e._v(" "),l("el-input",{attrs:{placeholder:e.$t("customer.placeholder49"),clearable:"",size:"small"},model:{value:e.rules.account,callback:function(t){e.$set(e.rules,"account","string"===typeof t?t.trim():t)},expression:"rules.account"}})],1)],1):e._e(),e._v(" "),e.rules.types>2?l("div",{staticClass:"form-item"},[l("el-form-item",[l("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(e.$t("customer.billingaddress"))+":")]),e._v(" "),l("el-input",{attrs:{placeholder:e.$t("customer.placeholder50"),clearable:"",size:"small"},on:{input:function(t){return e.onInput()}},model:{value:e.rules.address,callback:function(t){e.$set(e.rules,"address",t)},expression:"rules.address"}})],1)],1):e._e(),e._v(" "),e.rules.types>2?l("div",{staticClass:"form-item"},[l("el-form-item",[l("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(e.$t("customer.tel"))+":")]),e._v(" "),l("el-input",{attrs:{placeholder:e.$t("customer.placeholder51"),clearable:"",size:"small"},model:{value:e.rules.tel,callback:function(t){e.$set(e.rules,"tel","string"===typeof t?t.trim():t)},expression:"rules.tel"}})],1)],1):e._e()]),e._v(" "),l("div",{staticClass:"line"}),e._v(" "),l("div",{staticClass:"form-box"},[l("div",{staticClass:"form-item",staticStyle:{width:"100%"}},[l("el-form-item",[l("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(e.$t("public.remarks"))+":")]),e._v(" "),l("el-input",{attrs:{placeholder:e.$t("customer.placeholder18"),rows:4,maxlength:"255","show-word-limit":"",type:"textarea"},model:{value:e.rules.mark,callback:function(t){e.$set(e.rules,"mark",t)},expression:"rules.mark"}})],1)],1)])]),e._v(" "),l("div",{staticClass:"button from-foot-btn fix btn-shadow"},[l("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v(e._s(e.$t("public.cancel")))]),e._v(" "),l("el-button",{attrs:{loading:e.loading,size:"small",type:"primary"},on:{click:function(t){return e.handleConfirm("ruleForm")}}},[e._v(e._s(e.$t("public.ok")))])],1)],1)])],1)},s=[],r=l("a30a"),i=l("6b64"),o={name:"InvoiceApply",props:{contractInvoice:{type:String,default:""},formData:{type:Object,default:function(){return{}}},title:{type:String,default:""}},data:function(){var e=this,t=function(t,l,a){i["a"].mailboxReg;return l?a():a(new Error(e.$t("customer.placeholder68")))},l=function(t,l,a){if(!l&&e.rules.types>1)return a(new Error(e.$t("customer.placeholder47")));i["a"].identReg.test(l)?a():a(new Error("税号输入不合法"))};return{drawer:!1,direction:"rtl",categoryList:[],eid:0,cid:0,rules:{name:"",source:"",price:"",collect_type:"mail",amount:void 0,bill_date:"",types:2,title:"",ident:"",mail_address:"",bank:"",account:"",tel:"",mark:"",collect_name:"",collect_tel:"",method:"mail",addressBox:"",collect_email:"",address:"",category_id:""},methodOptions:[{value:"express",label:this.$t("customer.express")},{value:"mail",label:this.$t("customer.mail")}],loading:!1,invoiceOptions:[{value:1,label:this.$t("customer.personalinvoice")},{value:2,label:this.$t("customer.enterpriseinvoice")},{value:3,label:this.$t("customer.specialinvoice")}],rule:{name:[{required:!0,message:this.$t("customer.placeholder42"),trigger:"blur"}],amount:[{required:!0,message:this.$t("customer.placeholder44"),trigger:"blur"}],bill_date:[{required:!0,message:this.$t("customer.placeholder65"),trigger:"blur"}],title:[{required:!0,message:this.$t("customer.placeholder46"),trigger:"blur"}],ident:[{required:!0,validator:l,trigger:"blur"}],category_id:[{required:!0,message:"请选择发票类目",trigger:"change"}],collect_name:[{required:!0,message:"电话号码不能为空",trigger:"blur"}],collect_tel:[{required:!0,message:"电话号码不能为空",trigger:"blur"}],collect_email:[{required:!0,validator:t,trigger:"blur"}],mail_address:[{required:!0,message:"请填写邮寄地址",trigger:"blur"}],address:[{required:!0,message:"请填写开票地址",trigger:"blur"}],bank:[{required:!0,message:this.$t("customer.placeholder48"),trigger:"blur"}],account:[{required:!0,message:this.$t("customer.placeholder49"),trigger:"blur"}],tel:[{required:!0,message:"电话号码不能为空",trigger:"blur"}]}}},computed:{lang:function(){return this.$store.getters.lang}},watch:{formData:{handler:function(e){var t=this;e.edit||(0==e.data.cid&&(this.eid=e.data.id,this.cid=0),e.data.eid&&(this.eid=e.data.eid,this.cid=e.data.id),this.rules.name=e.data.title||"--",e.data.name?this.rules.source=e.data.name:this.rules.source=e.data.client?e.data.client.name:"--",e.oneData?(this.rules=e.oneData,this.rules.source=e.data.name?e.data.name:e.data.client.name,this.rules.types=Number(e.oneData.types),setTimeout((function(){t.rules.category_id=e.oneData.category_id}),200)):this.rules.address="",this.rules.bill_date=this.$moment(new Date).format("YYYY-MM-DD"),this.rules.price=e.data.price)},deep:!0},lang:function(){this.setOptions()}},methods:{setOptions:function(){this.methodOptions=[{value:"express",label:this.$t("customer.express")},{value:"mail",label:this.$t("customer.mail")}],this.invoiceOptions=[{value:1,label:this.$t("customer.personalinvoice")},{value:2,label:this.$t("customer.enterpriseinvoice")},{value:3,label:this.$t("customer.specialinvoice")}]},change:function(e){this.$forceUpdate()},handleClose:function(){this.drawer=!1,this.reset()},openBox:function(e){var t=this;e&&Object(r["Bb"])(e).then((function(e){t.rules=e.data,t.rules.source=e.data.client?e.data.client.name:"--",t.eid=e.data.client?e.data.client.id:e.data.eid,t.rules.name=e.data.treaty?e.data.treaty.title:"--",t.cid=e.data.treaty?e.data.treaty.id:e.data.cid,t.rules.types=Number(e.data.types)})),this.drawer=!0},collectTypeFn:function(e){this.rules.collect_type=e},onInput:function(){this.$forceUpdate()},reset:function(){for(var e in this.rules)this.rules[e]="";this.rules.amount=void 0,this.rules.types=2,this.rules.collect_type="mail"},handleMethod:function(){this.$refs.form.clearValidate("address"),this.$refs.form.clearValidate("mailbox")},handleConfirm:function(){var e=this;this.$refs.form.validate((function(t){if(t){var l=e.rules;l.bill_date=e.$moment(e.rules.bill_date).format("yyyy-MM-DD"),l.cid=e.cid,l.eid=e.eid;var a={eid:e.formData.data.eid,category_id:e.rules.category_id},s=JSON.parse(localStorage.getItem("categoryList"));if(s){var r=s.find((function(t){return t.eid==e.formData.data.eid}));r?s.map((function(e){e.eid==a.eid&&(e.category_id=a.category_id)})):s.push(a)}localStorage.setItem("categoryList",JSON.stringify(s)),e.formData.edit?e.invoiceEdit(e.formData.rowData.id,l):e.invoiceSave(l)}}))},invoiceSave:function(e){var t=this;this.loading=!0,Object(r["Gb"])(e).then((function(e){t.handleClose(),t.$emit("isOk"),t.reset(),t.loading=!1})).catch((function(e){t.loading=!1}))},invoiceEdit:function(e,t){var l=this;this.loading=!0,Object(r["Cb"])(e,t).then((function(e){l.handleClose(),l.$emit("isOk"),l.reset(),l.loading=!1})).catch((function(e){l.loading=!1}))}}},c=o,n=(l("f1a9"),l("2877")),u=Object(n["a"])(c,a,s,!1,null,"47f40bda",null);t["default"]=u.exports},e199:function(e,t,l){},f1a9:function(e,t,l){"use strict";l("e199")}}]);