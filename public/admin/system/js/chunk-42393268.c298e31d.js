(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42393268"],{"03ab":function(t,e,s){"use strict";s("8111")},8111:function(t,e,s){},c8db:function(t,e,s){},e7ca:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{},[s("el-popover",{ref:"treePopover",attrs:{placement:"bottom-start","popper-class":"popover",width:t.isSite?306:266,trigger:"manual"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[s("div",{staticClass:"tree-box"},[s("div",{staticClass:"input"},[s("el-input",{staticStyle:{width:"218px"},attrs:{placeholder:"请输入部门搜索","prefix-icon":"el-icon-search",size:"small"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}})],1),t._v(" "),s("el-tree",{ref:"tree",attrs:{"check-strictly":!0,data:t.treeData,"default-checked-keys":t.selectIds,"default-expanded-keys":t.treeExpandData,"filter-node-method":t.filterNode,indent:8,props:t.props,"show-checkbox":!t.onlyOne,"highlight-current":"","node-key":"id"},on:{"check-change":t.depCheck},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node,a=e.data;return s("span",{staticClass:"custom-tree-node"},[s("div",{staticClass:"flex flex-between"},[s("div",{staticClass:"flex",class:{isChecked:t.departmentIds.includes(a.id)},on:{click:function(e){return e.stopPropagation(),t.append(i,a)}}},[s("i",{staticClass:"tree-icon iconfont iconwenjianjia"}),t._v(" "),s("span",{staticClass:"label-text over-text"},[t._v(t._s(a.label))])]),t._v(" "),t.isSite&&t.departmentIds.includes(a.id)?s("div",{staticClass:"main-department",class:{checkedColor:a.id==t.is_mastartId},on:{click:function(e){return e.stopPropagation(),t.isMastart(a)}}},[t._v("\n              "+t._s(a.id==t.is_mastartId?"主部门":"设为主部门")+"\n            ")]):t._e()])])}}])})],1),t._v(" "),s("template",{slot:"reference"},[t._t("custom"),t._v(" "),t.isSlots?t._e():s("div",{ref:"select",staticClass:"select plan-footer-one mr10",on:{click:t.handlePopoverShow}},[t.selectList&&0==t.selectList.length?s("span",{staticClass:"placeholder"},[t._v(t._s(t.placeholder))]):t._e(),t._v(" "),t.selectList.length>0&&!t.isSearch?s("div",{staticClass:"flex-box"},t._l(t.selectList,(function(e,i){return s("span",{key:i,staticClass:"el-tag el-tag--small el-tag--info el-tag--light mr10",on:{click:function(t){t.stopPropagation()}}},[t._v("\n            "+t._s(e.label||e.name)+" "),t.isSite&&e.id==t.is_mastartId?s("span",[t._v("(主)")]):t._e(),t._v(" "),s("i",{staticClass:"el-tag__close el-icon-close",on:{click:function(e){return e.stopPropagation(),t.cardTag(i)}}})])})),0):t._e(),t._v(" "),t.selectList.length>0&&t.isSearch?s("div",{staticClass:"flex"},[t._l(t.selectList.slice(0,1),(function(e,i){return s("div",{key:i,staticClass:"el-tag el-tag--small el-tag--info el-tag--light mr10 flex-search",on:{click:function(t){t.stopPropagation()}}},[s("span",{staticClass:"left over-text"},[t._v(" "+t._s(e.label||e.name))]),t._v(" "),s("i",{staticClass:"right el-tag__close el-icon-close",on:{click:function(e){return e.stopPropagation(),t.cardTag(0)}}})])})),t._v(" "),t.selectList.length>1?s("el-tag",{staticClass:"el-tag el-tag--small el-tag--info el-tag--light mt3"},[t._v("\n            "+t._s(t.selectList.length-1))]):t._e()],2):t._e()])],2)],2)],1)},a=[],n=s("02df");function r(t,e){var s="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!s){if(Array.isArray(t)||(s=l(t))||e&&t&&"number"===typeof t.length){s&&(t=s);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r=!0,o=!1;return{s:function(){s=s.call(t)},n:function(){var t=s.next();return r=t.done,t},e:function(t){o=!0,n=t},f:function(){try{r||null==s.return||s.return()}finally{if(o)throw n}}}}function l(t,e){if(t){if("string"===typeof t)return o(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}var c={name:"",props:{value:{type:Array,default:function(){return[]}},isSite:{type:Boolean,default:!1},placeholder:{type:String,default:"请选择部门"},onlyOne:{type:Boolean,default:!1},isSearch:{type:Boolean,default:!1},role:{type:Number,default:0},disabledList:{type:Array,default:function(){return[]}}},data:function(){return{props:{children:"children",label:"label"},showPopover:!1,isSlots:!1,treeHeight:"",filterText:"",selectIds:[],is_mastartId:0,treeExpandData:[],departmentIds:[],selectList:[],treeData:[]}},computed:{},watch:{filterText:function(t){this.$refs.tree.filter(t)},value:function(t,e){var s=this;this.selectList=t,this.departmentIds=Object(n["a"])(this.selectList),this.selectIds=this.findNamesByIds(this.treeData,this.departmentIds),this.$refs.tree.setCheckedKeys(this.selectIds),this.isSite&&this.selectList.map((function(t){t.is_mastart&&(s.is_mastartId=t.id)}))}},mounted:function(){var t=this;document.addEventListener("click",this.handleGlobalClick),this.$slots.custom&&(this.isSlots=!0),this.getTreeData(),this.value.length>0&&(this.selectList=this.value,this.departmentIds=Object(n["a"])(this.selectList),this.isSite&&this.selectList.map((function(e){e.is_mastart&&(t.is_mastartId=e.id)})))},methods:{handleGlobalClick:function(t){this.$refs.treePopover.$el.contains(t.target)||(this.showPopover=!1)},handlePopoverShow:function(){this.showPopover=!0},handlePopoverHide:function(){this.showPopover=!1},getRoleTreeRootNode:function(t){var e;this.treeExpandData.push(null===(e=t[0])||void 0===e?void 0:e.id)},cardTag:function(t){this.selectList.splice(t,1),this.$emit("changeMastart",this.selectList)},isMastart:function(t){var e=this;t.is_mastart||(this.is_mastartId=t.id),this.selectList.forEach((function(t){t.id==e.is_mastartId?t.is_mastart=!0:t.is_mastart=!1})),this.$emit("changeMastart",this.selectList)},depCheck:function(t,e){if(this.disabledList.includes(t.id))return this.$message.warning("此部门已加入其他考勤组");e?(this.selectList.push({id:t.id,value:t.value,label:t.label,name:t.label,is_mastart:!1,pid:t.pid,path:t.path}),this.selectList=Object(n["n"])(this.selectList)):this.selectList=this.selectList.filter((function(e){return e.id!==t.id})),this.departmentIds=Object(n["a"])(this.selectList),this.$emit("changeMastart",this.selectList)},filterNode:function(t,e){return!t||-1!==e.label.indexOf(t)},append:function(t,e){return this.disabledList.includes(e.id)?this.$message.warning("此部门已加入其他考勤组"):!!this.onlyOne&&(Object(n["j"])(this.departmentIds,e.id)?this.$message.warning("已选中该部门"):(e.is_mastart=!1,this.selectList=[{id:e.id,value:e.value,label:e.label,name:e.label,is_mastart:!1,pid:e.pid,path:e.path}],this.departmentIds=Object(n["a"])(this.selectList),this.$emit("changeMastart",this.selectList),void this.$refs.treePopover.doClose()))},getTreeData:function(){this.treeData=this.$store.state.user.departmentList,this.getRoleTreeRootNode(this.treeData),this.selectIds=this.findNamesByIds(this.treeData,this.departmentIds)},findNamesByIds:function(t,e){var s=e.map((function(t){return parseInt(t)})),i=[];function a(t){if(s.includes(t.value)&&0!=t.type&&i.push(t.id),t.children){var e,n=r(t.children);try{for(n.s();!(e=n.n()).done;){var l=e.value;a(l)}}catch(o){n.e(o)}finally{n.f()}}}var n,l=r(t);try{for(l.s();!(n=l.n()).done;){var o=n.value;a(o)}}catch(c){l.e(c)}finally{l.f()}return i},getDepartmentDataById:function(t,e){var s=t;if(s){var i=function t(e){e.forEach((function(e){e.children?t(e.children):a.push(e)}))},a=[];return i([s]),a}return[]},getSubDepartmentsById:function(t,e){var s=[];function i(t){var e,a=r(t);try{for(a.s();!(e=a.n()).done;){var n=e.value;s.push({id:n.id,value:n.value,label:n.label,name:n.label,is_mastart:!1,pid:n.pid,path:n.path}),n.children&&n.children.length>0&&i(n.children)}}catch(l){a.e(l)}finally{a.f()}}return i(t),s}},beforeDestroy:function(){document.removeEventListener("click",this.handleGlobalClick)}},d=c,h=(s("03ab"),s("ee15"),s("2877")),u=Object(h["a"])(d,i,a,!1,null,"1638c02d",null);e["default"]=u.exports},ee15:function(t,e,s){"use strict";s("c8db")}}]);