(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9d2b2180"],{a4fef:function(t,e,n){},b096:function(t,e,n){"use strict";n("a4fef")},f9e2:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"box-container"},[r("el-drawer",{attrs:{visible:t.drawer,direction:"rtl","before-close":t.handleClose,size:"75%","append-to-body":!0,modal:!0,"wrapper-closable":!0},on:{"update:visible":function(e){t.drawer=e}}},[t._t("default",[r("div",{staticClass:"tabsEdit"},[r("div",{staticClass:"tabs"},[r("el-tabs",{staticClass:"cr-header-tabs",on:{"tab-click":t.handleClick},model:{value:t.tabsName,callback:function(e){t.tabsName=e},expression:"tabsName"}},[r("el-tab-pane",{attrs:{label:"未读",name:"1"}}),t._v(" "),r("el-tab-pane",{attrs:{label:"全部",name:"2"}})],1)],1)])],{slot:"title"}),t._v(" "),r("div",{staticClass:"flex"},[r("div",{staticClass:"left"},[r("div",{staticClass:"type",class:0==t.activeId?"active":"",on:{click:function(e){return t.handleTypes({id:""})}}},[t._v("\n          全部类型\n        ")]),t._v(" "),t._l(t.options,(function(e,n){return r("div",{key:n,staticClass:"type",class:t.activeId==e.value?"active":"",on:{click:function(n){return t.handleTypes(e)}}},[t._v("\n          "+t._s(e.cate_name)+" "),0!=e.count?r("span",{staticClass:"num"},[t._v(t._s(e.count))]):t._e()])}))],2),t._v(" "),r("div",{staticClass:"right"},[r("div",{staticClass:"mt20"},[r("el-input",{staticStyle:{width:"250px"},attrs:{"prefix-icon":"el-icon-search",clearable:"",size:"small",placeholder:"请输入标题/内容"},on:{change:t.getList},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.stopPropagation(),e.preventDefault(),t.getList(e))}},model:{value:t.where.name,callback:function(e){t.$set(t.where,"name",e)},expression:"where.name"}})],1),t._v(" "),r("div",{staticClass:"mt10"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{data:t.tableData,height:t.height},on:{"selection-change":t.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"35"}}),t._v(" "),r("el-table-column",{attrs:{label:"查看",width:"50"},scopedSlots:t._u([{key:"default",fn:function(t){return[r("el-image",{attrs:{src:0===t.row.is_read?n("8bbc"):n("2070")}})]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"title",label:"消息标题","min-width":"80"}}),t._v(" "),r("el-table-column",{attrs:{prop:"message",label:"消息内容","min-width":"360"}}),t._v(" "),r("el-table-column",{attrs:{prop:"cate_name",label:"类型","min-width":"80"}}),t._v(" "),r("el-table-column",{attrs:{prop:"created_at",label:"发送时间","min-width":"120"}}),t._v(" "),r("el-table-column",{attrs:{label:t.$t("toptable.operation"),width:"100",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.buttons,(function(n,a){return r("el-button",{key:a,attrs:{type:"text",disabled:t.selectedType.includes(n.action)},on:{click:function(r){return t.handleDetails(e.row,n)}}},["考勤"!==e.row.cate_name?r("span",[t._v(" "+t._s(n.title))]):t._e()])}))}}])})],1),t._v(" "),r("div",{staticClass:"footer"},[r("div",{staticClass:"isSelect"},[r("div",{staticClass:"flex",staticStyle:{display:"inline-block"}},[r("el-button",{attrs:{size:"small"},on:{click:function(e){return t.handleRead()}}},[t._v("全部已读")]),t._v(" "),r("el-button",{attrs:{size:"small",disabled:0==t.multipleSelection.length},on:{click:function(e){return t.handleRead(1)}}},[t._v("标记为已读")]),t._v(" "),r("el-button",{attrs:{size:"small",disabled:0==t.multipleSelection.length},on:{click:t.handleDelete}},[t._v("批量删除")])],1)]),t._v(" "),r("div",{staticClass:"paginationClass"},[r("el-pagination",{attrs:{"page-size":t.where.limit,"current-page":t.where.page,"page-sizes":[15,20,30],layout:"total,sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.pageChange}})],1)])],1)])])],2),t._v(" "),r("message-handle-popup",{ref:"messageHandlePopup",attrs:{detail:t.detail},on:{handleClose:t.handleClose}})],1)},a=[],i=n("c24f"),o=n("90e7"),s=n("e876");function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */c=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,n){return t[e]=n}}function f(t,e,n,r){var i=e&&e.prototype instanceof b?e:b,o=Object.create(i.prototype),s=new P(r||[]);return a(o,"_invoke",{value:O(t,n,s)}),o}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p="suspendedStart",v="suspendedYield",g="executing",m="completed",y={};function b(){}function w(){}function _(){}var x={};h(x,o,(function(){return this}));var L=Object.getPrototypeOf,C=L&&L(L(z([])));C&&C!==n&&r.call(C,o)&&(x=C);var k=_.prototype=b.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(a,i,o,s){var c=d(t[a],t,i);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==l(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,s)}))}s(c.arg)}var i;a(this,"_invoke",{value:function(t,r){function a(){return new e((function(e,a){n(t,r,e,a)}))}return i=i?i.then(a,a):a()}})}function O(e,n,r){var a=p;return function(i,o){if(a===g)throw Error("Generator is already running");if(a===m){if("throw"===i)throw o;return{value:t,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var l=j(s,r);if(l){if(l===y)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===p)throw a=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=g;var c=d(e,n,r);if("normal"===c.type){if(a=r.done?m:v,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a=m,r.method="throw",r.arg=c.arg)}}}function j(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,j(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=d(a,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function z(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(l(e)+" is not iterable")}return w.prototype=_,a(k,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:w,configurable:!0}),w.displayName=h(_,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,h(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},S(E.prototype),h(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new E(f(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(k),h(k,u,"Generator"),h(k,o,(function(){return this})),h(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=z,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return s.type="throw",s.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;T(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:z(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function u(t,e,n,r,a,i,o){try{var s=t[i](o),l=s.value}catch(c){return void n(c)}s.done?e(l):Promise.resolve(l).then(r,a)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(t){u(i,r,a,o,s,"next",t)}function s(t){u(i,r,a,o,s,"throw",t)}o(void 0)}))}}var f={name:"noticeList",components:{messageHandlePopup:function(){return Promise.resolve().then(n.bind(null,"5507"))}},data:function(){return{drawer:!1,loading:!1,tabsName:"1",activeId:0,height:"calc(100vh - 240px)",tableData:[],detail:{},options:[],multipleSelection:[],selectedType:["delete","recall"],total:0,where:{page:1,limit:15,title:"",cate_id:"",name:"",is_read:"0"}}},methods:{openBox:function(){this.getMessageCate(),this.getList(),this.drawer=!0,this.tabsName="1"},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;1===e&&(this.loading=!0),Object(i["S"])(this.where).then((function(n){1===e&&(t.loading=!1),t.tableData=n.data.list,t.total=n.data.messageNum})).catch((function(n){1===e&&(t.loading=!1)}))},handleRead:function(t,e){var n=this,r=[];1==t?(this.multipleSelection.forEach((function(t){r.push(t.id)})),Object(i["T"])(1,e||{ids:r}).then((function(t){n.getList(),n.getMessageCate()}))):this.where.cate_id?Object(i["T"])(1,{cate_id:this.where.cate_id}).then((function(t){n.getList(),n.getMessageCate()})):Object(i["T"])(1,{}).then((function(t){n.getList(),n.getMessageCate()}))},handleTypes:function(t){this.where.cate_id=t.id,this.activeId=t.id,this.where.page=1,this.getList()},getMessageCate:function(){var t=this;return h(c().mark((function e(){var n;return c().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["J"])();case 2:n=e.sent,t.options=n.data;case 4:case"end":return e.stop()}}),e)})))()},handleDelete:function(){var t=this;this.multipleSelection.length<=0?this.$message.error("至少选择一项内容"):this.$modalSure("删除后不可恢复,您确认要删除吗").then((function(){var e=[];t.multipleSelection.map((function(t){e.push(t.id)})),t.batchMessageDelete({ids:e})}))},batchMessageDelete:function(t){var e=this;Object(i["R"])(t).then((function(n){var r=Math.ceil((e.total-t.ids.length)/e.where.limit),a=e.where.page>r?r:e.where.page;e.where.page=a<1?1:a,e.getList(),e.getMessageCate()}))},handleSelectionChange:function(t){this.multipleSelection=t},handleDetails:function(t,e){var n=this;return h(c().mark((function r(){return c().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n.detail=t,r.next=3,n.$nextTick();case 3:n.$refs.messageHandlePopup.openMessage(e,t),0===t.is_read&&n.handleRead(1,{ids:[t.id]});case 5:case"end":return r.stop()}}),r)})))()},pageChange:function(t){this.where.page=t,this.getList()},handleSizeChange:function(t){this.where.limit=t,this.getList()},handleClose:function(){var t=this;this.drawer=!1,Object(s["j"])({page:1,limit:1}).then((function(e){var n=e.data.messageNum?e.data.messageNum:0;t.$store.commit("user/SET_MESSAGE",n)}))},handleClick:function(){this.where.page=1,2==this.tabsName?this.where.is_read="":this.where.is_read="0",this.getList()}}},d=f,p=(n("b096"),n("2877")),v=Object(p["a"])(d,r,a,!1,null,"1aea2aa8",null);e["default"]=v.exports}}]);