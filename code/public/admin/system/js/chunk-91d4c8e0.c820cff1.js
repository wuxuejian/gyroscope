(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-91d4c8e0"],{3786:function(t,e,a){"use strict";a("e6fb")},"6fd8":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{attrs:{title:t.title,visible:t.dialogFormVisible,modal:!0,width:"846px","before-close":t.closeDialog,"show-close":!0},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"dialog-title-title"},[t._v(t._s(t.title))])]),t._v(" "),i("el-row",[i("el-col",{attrs:{span:4}},[i("div",{staticClass:"assess-left"},[i("ul",{staticClass:"assess-left-ul"},t._l(t.department,(function(e,a){return i("li",{key:a,class:a==t.tabIndex?"active":"",on:{click:function(i){return t.clickDepart(a,e.id)}}},[i("span",[t._v(t._s(e.name))])])})),0)])]),t._v(" "),i("el-col",{attrs:{span:13}},[i("div",{staticClass:"ml15"},[i("div",{staticClass:"content-temp"},[i("el-input",{staticClass:"input-with-select",attrs:{size:"small",placeholder:"请输入模板名称"},on:{change:t.searchFn},model:{value:t.where.name,callback:function(e){t.$set(t.where,"name",e)},expression:"where.name"}}),t._v(" "),i("el-scrollbar",[i("ul",{staticClass:"content-temp-ul"},t._l(t.tableData,(function(e,n){return i("li",{key:n,class:[(n+1)%3?"":"mr0",n==t.clickIndex?"active":""],on:{click:function(a){return t.selectList(e,n)},mouseenter:function(e){return t.showEnterItem(n)},mouseleave:function(e){return t.showLeaveItem(n)}}},[i("div",{staticClass:"temp-text",style:{color:e.color}},[i("p",{staticClass:"title textover"},[t._v(t._s(e.name))]),t._v(" "),i("p",{staticClass:"caption"},[t._v(t._s(e.info))]),t._v(" "),1===e.way?i("p",{staticClass:"icon-star"},[i("i",{staticClass:"el-icon-star-on",class:t.setIsCollect(e),on:{click:function(a){return a.stopPropagation(),t.statusStar(e)}}}),t._v(" "),i("i",{staticClass:"icon-caret-star"})]):t._e()]),t._v(" "),""!=e.cover?i("img",{attrs:{src:e.cover,alt:""}}):i("img",{attrs:{src:a("951a"),alt:""}}),t._v(" "),t.hoverIndex===n&&void 0!==e.user&&t.$store.state.user.userInfo.uid===e.user.uid?i("div",{staticClass:"footer",on:{click:function(t){return t.stopPropagation(),function(){return!1}()}}},[i("div",{staticClass:"pointer"},[i("span",{on:{click:function(a){return a.stopPropagation(),t.setPreviewImage(e)}}},[t._v("设置封面")])]),t._v(" "),i("div",{staticClass:"pointer"},[i("span",{on:{click:function(a){return a.stopPropagation(),t.handleEdit(e)}}},[t._v("编辑")])]),t._v(" "),i("div",{staticClass:"pointer",on:{click:function(a){return a.stopPropagation(),t.handleDelete(e)}}},[i("span",[t._v("删除")])])]):t._e()])})),0)])],1),t._v(" "),i("el-pagination",{attrs:{"page-size":t.where.limit,"current-page":t.where.page,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.pageChange}})],1)]),t._v(" "),i("el-col",{attrs:{span:7}},[i("div",{staticClass:"ml15"},[i("div",{staticClass:"template-preview"},[i("el-scrollbar",{staticStyle:{height:"100%"}},[i("p",{staticClass:"title"},[t._v(t._s(t.selectTitle))]),t._v(" "),t._l(t.selectDada,(function(e,a){return i("div",{key:a,staticClass:"template-preview-list"},[i("p",{staticClass:"caption"},[t._v(t._s(e.name))]),t._v(" "),i("ul",{staticClass:"template-preview-ul"},t._l(e.target,(function(e,a){return i("li",{key:a},[t._v(t._s(e.name))])})),0)])}))],2)],1)])])],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:t.closeDialog}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.handleConfirm}},[t._v("确定")])],1)],1),t._v(" "),i("preview",{ref:"preview",attrs:{title:"设置封面图",data:t.itemData},on:{handlePreview:t.handlePreview}})],1)},n=[],s=a("a30a"),l={name:"SelectTemplate",components:{preview:function(){return Promise.resolve().then(a.bind(null,"aee3"))}},props:{title:{type:String,default:""},remindButton:{type:Boolean,default:!1}},data:function(){return{dialogFormVisible:!1,search:"",type:1,where:{page:1,limit:9,name:""},tableData:[],total:0,selectDada:[],selectTitle:"",clickIndex:-1,hoverIndex:-1,cateId:"template",itemData:{},configData:{edit:1,data:{}},collects:[],templateValue:"",department:[],tabIndex:0,activeValue:"",optionValue:{id:"template",option:[]},isTemplate:!0}},watch:{},mounted:function(){var t=this;this.getTargetCate(),this.$nextTick((function(){t.tableData.length>0&&t.selectList(t.tableData[0],0)}))},methods:{clickDepart:function(t,e){this.tabIndex=t,this.optionValue.id=e,this.eventOptionData(this.optionValue)},handleShow:function(t){this.activeValue=t},handleHide:function(){this.activeValue=""},getTargetCate:function(){var t=this,e={types:this.type};Object(s["m"])(e).then((function(e){void 0===e.data?t.department=[]:t.department=e.data,0==t.isTemplate&&t.department.unshift({name:"全部",id:""}),1==t.type&&t.isTemplate&&t.department.unshift({name:"我的模板",id:"template"},{name:"我的收藏",id:"collect"}),t.optionDate()}))},addCate:function(){var t=this;this.$modalForm(Object(s["k"])(this.type)).then((function(e){e.message;t.getTargetCate()}))},addDivsion:function(){var t=this;this.$modalForm(Object(s["l"])(this.activeValue)).then((function(e){e.message;t.getTargetCate()}))},hanleDelete:function(){var t=this;this.$modalSure("你确定要删除这条指标模板分类吗").then((function(){Object(s["be"])(t.activeValue).then((function(e){t.getTargetCate()}))}))},optionDate:function(){var t=[];this.department.length<=0?(this.optionValue.option=t,this.eventOptionData(this.optionValue)):(this.department.map((function(e){t.push({label:e.name,id:e.id})})),this.optionValue.option=t,this.eventOptionData(this.optionValue))},openDialog:function(){this.dialogFormVisible=!0,this.getTableData()},closeDialog:function(){this.selectDada=[],this.clickIndex=-1,this.selectTitle="",this.dialogFormVisible=!1},searchFn:function(){this.getTableData(1)},handleConfirm:function(){var t=this;if(this.clickIndex<0)this.$message.error("选择为空");else{if(this.remindButton){var e=this.selectDada;this.$modalSure("确定后将替换原来的内容").then((function(){t.configData.edit=1,t.configData.data=e,t.$emit("templateChange",t.configData)}))}else this.configData.edit=1,this.configData.data=this.selectDada,this.$emit("templateChange",this.configData);this.closeDialog()}},getTableData:function(t){var e=this;1==t&&(this.where.page=1);var a={page:this.where.page,limit:this.where.limit,name:this.where.name,cate_id:this.cateId};Object(s["u"])(a).then((function(t){e.tableData=t.data.list,e.collects=t.data.collects?t.data.collects:[],e.total=t.data.count,e.tableData.length>0&&e.selectList(e.tableData[0],0)}))},pageChange:function(t){this.where.page=t,this.getTableData()},handleSizeChange:function(t){this.where.limit=t,this.getTableData()},setIsCollect:function(t){return"collect"===this.cateId?"active":0===this.collects.length?"":this.collects.includes(t.id)?"active":""},eventOptionData:function(t){this.cateId=t.id,this.where.page=1,this.clickIndex=-1,this.selectDada=[],this.selectTitle="",this.getTableData()},handleSelectionChange:function(t){this.multipleSelection=t},getRowKeys:function(t){return t.id},showEnterItem:function(t){this.hoverIndex=t},showLeaveItem:function(t){this.hoverIndex=-1},setPreviewImage:function(t){this.itemData=t,this.$refs.preview.openDialog()},handlePreview:function(){this.getTableData()},handleDelete:function(t){var e=this;this.$modalSure("考核模板删除后，将不可修改，你确定要删除吗").then((function(){Object(s["de"])(t.id).then((function(t){e.getTableData()}))}))},handleEdit:function(t){var e=this;Object(s["t"])(t.id).then((function(t){void 0===t.data?e.$message.error("内容为空，不能编辑"):(e.configData.edit=2,e.configData.data=t.data,e.$emit("templateChange",e.configData),e.closeDialog())}))},statusStar:function(t){var e=this;Object(s["s"])(t.id).then((function(t){"collect"===e.cateId&&(e.selectDada=[],e.selectTitle=""),e.getTableData()})).catch((function(e){t.collect=null}))},selectList:function(t,e){var a=this;this.clickIndex=e,this.selectTitle=this.tableData[e].name,Object(s["t"])(t.id,{way:t.way}).then((function(t){a.selectDada=t.data?t.data.info:[]}))}}},o=l,c=(a("3786"),a("2877")),r=Object(c["a"])(o,i,n,!1,null,"2407a4e4",null);e["default"]=r.exports},e6fb:function(t,e,a){}}]);